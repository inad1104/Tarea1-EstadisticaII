---
title: "Tarea 1"
author: "Ingrid Fonseca C03042-Esaú Ramirez C06348"
date: "2024-01-18"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Se cargan los paquetes necesarios para las funciones que se utilizan en esta tarea.

```{r}
echo=FALSE
#install.packages("ggthemes")
#install.packages("httr")
#install.packages("dplyr")
library(dplyr)
library(tidyverse)
library(ggplot2)
library(httr)
library(readr)
library(ggthemes)
library(httr)
library(univariateML)
library(rriskDistributions)

```

Seguidamente, se cargará la base de datos.

```{r}
BaseSalarios <- read_csv("BaseSalarios.csv",show_col_types = FALSE)

```

Hacemos un cambio en la variable sexo y cambiamos el número 1 por "hombre" y el número 2 por "mujer". Además, se divide la variable "U. Salario" entre 1000 para obtener los datos en miles.

```{r}
BaseSalarios$Sexo <- ifelse(BaseSalarios$Sexo == 1, 'hombre', 'mujer')
BaseSalarios$`U. Salario` <- BaseSalarios$`U. Salario`/1000
```

### Parte I.

#### 1.

Ahora se hace un análisis de los datos donde se obtiene la media, el mínimo, el máximo, la varianza y la desviación estandar para los salarios por sexo.

```{r}
media_salario_mujeres <- mean(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'mujer'])
media_salario_hombres <- mean(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'hombre'])
min_salario_mujeres <- min(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'mujer'])
min_salario_hombres <- min(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'hombre'])
max_salario_mujeres <- max(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'mujer'])
max_salario_hombres <- max(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'hombre'])
varianza_salario_mujeres <- var(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'mujer'])
varianza_salario_hombres <- var(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'hombre'])
desv_salario_mujeres <- sd(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'mujer'])
desv_salario_hombres <- sd(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'hombre'])


data_salarios <- data.frame(
  Sexo = c('mujer', 'hombre'),
  Media_Salario = c(media_salario_mujeres, media_salario_hombres),
  Min_Salario = c(min_salario_mujeres, min_salario_hombres),
  Max_Salario = c(max_salario_mujeres, max_salario_hombres),
  Varianza_Salario = c(varianza_salario_mujeres, varianza_salario_hombres),
  Desviacion_Salario = c(desv_salario_mujeres, desv_salario_hombres)
)

print(data_salarios)

```

De la misma manera, se obtiene la media, el mínimo, el máximo, la varianza y la desviación estandar para las cuotas aportadas por sexo.

```{r}
media_cuotas_mujeres <- mean(BaseSalarios$Coutas[BaseSalarios$Sexo == 'mujer'])
media_cuotas_hombres <- mean(BaseSalarios$Coutas[BaseSalarios$Sexo == 'hombre'])
min_cuotas_mujeres <- min(BaseSalarios$Coutas[BaseSalarios$Sexo == 'mujer'])
min_cuotas_hombres <- min(BaseSalarios$Coutas[BaseSalarios$Sexo == 'hombre'])
max_cuotas_mujeres <- max(BaseSalarios$Coutas[BaseSalarios$Sexo == 'mujer'])
max_cuotas_hombres <- max(BaseSalarios$Coutas[BaseSalarios$Sexo == 'hombre'])
varianza_cuotas_mujeres <- var(BaseSalarios$Coutas[BaseSalarios$Sexo == 'mujer'])
varianza_cuotas_hombres <- var(BaseSalarios$Coutas[BaseSalarios$Sexo == 'hombre'])
desv_cuotas_mujeres <- sd(BaseSalarios$Coutas[BaseSalarios$Sexo == 'mujer'])
desv_cuotas_hombres <- sd(BaseSalarios$Coutas[BaseSalarios$Sexo == 'hombre'])


data_cuotas <- data.frame(
  Sexo = c('mujer', 'hombre'),
  Media_cuotas = c(media_cuotas_mujeres, media_cuotas_hombres),
  Min_cuotas = c(min_cuotas_mujeres, min_cuotas_hombres),
  Max_cuotas = c(max_cuotas_mujeres, max_cuotas_hombres),
  Varianza_cuotas = c(varianza_cuotas_mujeres, varianza_cuotas_hombres),
  Desviacion_cuotas = c(desv_cuotas_mujeres, desv_cuotas_hombres)
)

print(data_cuotas)
```

#### 2.

Se crea un gráfico de cajas comparando el salario por sexo.

```{r}
# Boxplot por grupo
ggplot(data = BaseSalarios, aes(x = Sexo, y = `U. Salario`)) +
       stat_boxplot(geom = "errorbar", # Bigotes
                    width = 0.2) +
       geom_boxplot(fill = "#4271AE", colour = "#1F3552", # Colores
                    alpha = 0.9, outlier.colour = "red") +
       scale_y_log10(name = "Salario en miles") +  # Etiqueta de la variable continua
       scale_x_discrete(name = "Sexo") +        # Etiqueta de los grupos
       ggtitle("Gráfico de barras del salario por sexo") +       # Título del plot
       theme(axis.line = element_line(colour = "black", # Personalización del tema
                                      size = 0.25)) + theme_few()

```

#### 3.

A partir de los datos anteriores, se puede observar que el salario mínimo global es más bajo para las mujeres, con un valor de 10.223 miles de colones, en contraste con los hombres, cuyo salario mínimo es de 10.880 miles de colones. Además, el salario más alto de la base de datos corresponde a los hombres, con un valor de 13.199,89 miles de colones, mientras que las mujeres tienen un salario máximo de 7.290,15 miles de colones. En promedio, los hombres tienen un salario mayor que las mujeres. Estas diferencias demuestran la existencia de disparidades significativas en los salarios entre hombres y mujeres.

#### 4.

Ahora vamos a hacer una prueba de hipótesis. Sea $\mu_x$ la media salarial de las mujeres y sea $\mu_y$ la media salarial de los hombres. Se establece la hipótesis nula como: $H_0 = \mu_x > \mu_y$ y su hipótesis alternativa como $H_1 = \mu_x < \mu_y$. Ahora aplicamos la función "t.test" la cual compara dos medias.

```{r}
t.test(BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'mujer'],BaseSalarios$`U. Salario`[BaseSalarios$Sexo == 'hombre'])

```

A partir de la ejecución anterior podemos observar que el p-valor es un número muy pequeño por lo que se rechaza la hipótesis nula, por lo que llegamos a la misma conclusión anterior la cual es que los hombres en promedio poseen un salario mayor que las mujeres.

### Parte II.

```{r}
#Pregunta #2
m<-ggplot(BaseSalarios, aes(x = `U. Salario`)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "lightblue", alpha = 0.7) +
  labs(title = "Histogram of Your Column", x = "Salarios", y = "Frecuencia")

show(m)
```

```{r}
#D=density(BaseSalarios$`U. Salario`,kernel="rectangular")

#hist(BaseSalarios$`U. Salario`, main="DistribucionAsaltos-KernelUniforme", freq=FALSE) lines(D,lwd=2,lty=1,col ="blue")

#ggplot(BaseSalarios, aes(x = `U. Salario`)) +
#  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 1.5) + geom_line(D,lwd=2,lty=1,col ="blue") + 
  #labs(title = "Histogram of Your Column", x = "Salarios", y = "Frecuencia")

#ggplot(BaseSalarios, aes(x = `U. Salario`)) + geom_density(D, )

#ggplot(data = BaseSalarios, aes(x = `U. Salario`)) +
#  geom_density(fill = "skyblue", color = "black", alpha = 0.7) +
##  ggtitle("Density Plot") +
#  xlab("Values") +
#  ylab("Density")

d<-ggplot(data = BaseSalarios, aes(x = `U. Salario`)) + 
  geom_histogram(aes(y = ..count../sum(..count..)),binwidth = 1, fill = "blue", color = "lightblue", alpha = 0.7) +
  geom_density(bw = "nrd0", kernel='rectangular', color = "black", alpha = 0.7) +
  geom_density(bw = "nrd0", kernel='biweight',  color = "lightblue", alpha = 0.7) +
  geom_density(bw = "nrd0",kernel='gaussian', color = "yellow", alpha = 0.7)+
  geom_density(bw = "nrd0",kernel='epanechnikov', color = "red", alpha = 0.7) +
  geom_density(bw = "nrd0", kernel='triangular', color = "pink", alpha = 0.7) +
  geom_density(bw = "nrd0", kernel='cosine', color = "black", alpha = 0.7) 

show(d)

```

### Parte III.

#### 1.

El criterio de información de Akaike (AIC) hace una comparación entre modelos estadísticos en donde calcula qué tan bien se ajusta el modelo a los datos o conjunto de observaciones y escoge el mejor entre ambos. Este criterio se calcula como $AIC=2\cdot P - 2(log-verosimilitud)$ donde $P$ es la cantidad de parámetros y la log-verosimilitud del modelo, es escoge el modelo cuyo $AIC$ es menor.

#### 2.

```{r}
prueba <- model_select(BaseSalarios$`U. Salario`, models = univariateML_models, criterion = "aic")

print(prueba)

```

A través de los resultados anteriores, la función aplicada con el criterio AIC mostró que la densidad que mejor se acopla a los datos es una distribución t-Student.

#### 3.

```{r,error = TRUE}

fit.cont(BaseSalarios$`U. Salario`)



```

Dados los datos anteriores se puede observar que la distribución que mejor se adapta a los datos dado el criterio AIC es la distribución Weibull ya que es la que presenta el menor AIC.

#### 4.

```{r}
AIC(prueba)
```

La distribución t-Student presenta un valor de AIC de 1640063 mientras que la distribución Weibull da un valor de AIC de 1640538.86, por lo tanto, la distribución que mejor se acopla a los datos es la t-Student porque es la que posee un menor AIC.

#### 5.

Ahora se creará un intervalo de confianza para la media y la desviación estándar.

```{r}
bootstrapml(prueba,
  reps = 100,
  map = identity,
  reducer = stats::quantile)
```

Dado los datos anteriores el intervalo de confianza para la media es de [1075.0125,1064.0848] y para la desviacion estandar es de [613.8814,619.85].

### Parte IV.

#### 1.

#### 2.

#### 3.

##### a.

##### b.
